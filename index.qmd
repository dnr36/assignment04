---
title: "Data Science for Public Policy"
subtitle: "Assignment 04"
author: "Juan Menendez - jmm676 & Diana Rivas - dnr36"
execute:
  warning: false
format:
  html:
    embed-resources: true
---

## Political Institutions in the World

The Database of Political Institutions presents institutional and electoral results data such as measures of checks and balances, tenure and stability of the government, identification of party affiliation and ideology, and fragmentation of opposition and government parties in the legislature, among others. The current version of the database, which is now hosted at the IDB, expands its coverage to about 180 countries for 40 years. Researchers at the World Bank Development Research Group first compiled the database in 2000. It has become one of the most cited databases in comparative political economy and comparative political institutions. Almost 3,000 studies have used this database so far as a source of institutional and political data in their empirical analysis.

```{r}
library(haven)
setwd ("/Users/Juan/Desktop/Georgetown/Coursework/2_Second_Semester/Data_Science/assignment04")
Institutions <- read_dta("dpi2012.dta")
```

# 1. Ideologies

## 1.1 Ruling ideologies

In the following graph, we present the evolution of the number of ruling parties according to their declared ideology. The red line indicates the share of ruling *leftist parties* and the blue line corresponds to *right parties*. The *center parties* are represented by the remainder.

```{r}
library(dplyr)
library(ggplot2)
library(ggthemes)

Institutions <- Institutions %>%
  mutate(execright = case_when(
    execrlc == 1 ~ 1,
    TRUE ~ 0
    ))

Institutions <- Institutions %>%
  mutate(execleft = case_when(
    execrlc == 3 ~ 1,
    TRUE ~ 0
  ))

Institutions %>%
  ggplot() + 
  geom_smooth(mapping = aes (year, execright), color = "blue") + 
  geom_smooth(mapping = aes (year, execleft), colour = "red") +
  scale_y_continuous() +
  labs(
    title = "Chief Executive Party Orientation - World",
    x = "Year",
    y = "% of countries in the sample") +
  theme_fivethirtyeight()
```

We can observe a sustained decreasing trend in the number of leftist parties in the world since 1975 to 2012. Right parties display an inverted U shape, with a peak around 1995 (the neoliberal momentum), and a minimum for 2012 that is nevertheless higher than what we see in 1975. Ruling parties perceived as "center" accounted for roughly 55% in 1975 and in 2012.

## 1.2 Ideologies and electoral support

In the following graph we aim to explore whether certain ideologies are better in achieving widespread support when winning elections. To do so, we sorted the vote share obtained by the ruling party in the last elections according to their ideology:

```{r}
# Define labels for Ideology variable
ideology_labs <- c("Right", "Center", "Left")

# Create a scatter plot with labels
Institutions %>%
  filter(execrlc > 0 & percentl > 5 & !is.na(percentl)) %>%
  ggplot(mapping = aes(x = execrlc, y = percentl)) +
  geom_point() +
  labs(title = "Relationship between ruling party ideology and Votes",
       x = "Ideology",
       y = "Percentage of Votes Obtained") +
  scale_x_continuous(breaks = c(1, 2, 3), labels = ideology_labs) 
```

At a glance, it seems that the right parties tend to earn popular support in higher amounts. However, it is contestable whether a system in which the ruling coalition wins with more than 70% of the votes can be considered a democracy in the Schumpeterian defenition (a competitive system). If we were to run a Chi-square test to uncover the existence of any statistical pattern, we should first deal with these outliers. Once that is done, the graph should display an equal distribution amongst the three party orientations. The `echo: false` option disables the printing of code (only output is displayed).
